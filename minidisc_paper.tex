%\documentclass[preprint]{aastex}
\documentclass{emulateapj}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{natbib}

\bibliographystyle{apj}

%\textwidth 6.5in
%\textheight 8.5in
%\topmargin = 0mm
%\evensidemargin = 0mm
%\oddsidemargin = 0mm

%Custom Commands
\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\gam}{\gamma}
\newcommand{\Gam}{\Gamma}
\newcommand{\de}{\delta}
\newcommand{\De}{\Delta}
\newcommand{\eps}{\epsilon}
\newcommand{\sig}{\sigma}
\newcommand{\Sig}{\Sigma}
\newcommand{\ka}{\kappa}
\newcommand{\lam}{\lambda}
\newcommand{\om}{\omega}
\newcommand{\Om}{\Omega}
\newcommand{\Mach}{\mathcal{M}}
\newcommand{\pd}{\partial}
\newcommand{\dd}{\mbox{d}}

\newcommand{\DISCO}{{\texttt{DISCO}}}

\newcommand{\OO}{\mathcal{O}}

\begin{document}

\title{Minidiscs in Circumbinary Black Hole Accretion}
\author{Geoffrey Ryan\altaffilmark{1,a} and Andrew MacFadyen\altaffilmark{1}}
\altaffiltext{a}{gsr257@nyu.edu}
\altaffiltext{1}{Center for Cosmology and Particle Physics, Physics Department, New York University, NY, NY 10003, USA}

\begin{abstract}

Newtonian calculations have demonstrated circumbinary black hole accretion is mediated by minidiscs around each black hole, fed by streams from the global circumbinary disc. We study the structure of black hole minidiscs using general relativistic hydrodynamics calculations of minidiscs with the moving mesh hydro code Disco. Torques from the binary companion induce spiral shocks in the disc which can effectively dissipate energy and transport angular momentum outwards; inducing accretion onto the central black hole. The disc is cooled with a local blackbody prescription, allowing evolution to a self-consistent temperature profile.  The shock structure agrees well with the relativistic dispersion relation for tightly-wound linear waves. We measure the shock induced dissipation, find effective alpha parameters on the order of 0.01, and produce disc spectra from the blackbody emission.

\end{abstract}


%%%%%
%Section 1 - Introduction
%%%%%

\section{Introduction}
\label{sec:intro}

Recent developments have generated much interest in black hole binaries.  Several studies (CITE GRAHAM, MARIA) have identified candidate supermassive black hole (SMBH) binaries using variability of quasar light curves.  LIGO/VIRGO (cite LIGO) has detected two mergers of stellar-mass black holes, the first measurement of general relativity in the strong field regime.

SMBH binaries are thought to be somewhat ubiquitous in the universe.  Present day galaxies are the result of several past mergers, indicating they have certainly housed SMBH binaries many times over their history. The mechanism by which SMBH binaries actually merge is still a matter of much debate. The ``final parsec problem,'' that dynamical friction with stellar bodies ceases to be effective at merging a SMBH binary when the separation $a \lesssim 1pc$, indicates non-gravitational processes may play an important role.

EM counterparts --> gas dynamics

The global structure of circumbinary accretion is an active problem.  Much work has been done using both analytic (CITE Zoltan, Rafikov, others?) and numerical (CITE Milos MacFadyen, Brian, Dan etc) methods. Through this a highly dynamic picture has emerged.  At large distances $r \gg a$ the circumbinary disc resembles a Shakura-Sunyaev thin disc around a point mass $M_{bin}$.  In the inner region $r \sim a$ the binary carves a cavity out of the global disc.  Gas flows from the cavity wall in streams, feeding a persistent ``minidisc'' around each black hole.  Gas can be traded between black holes and flung back to the cavity walls, exciting non-axisymmetric lumps which precess around the cavity wall. Overall accretion rates are similar to those expected from single BH discs.  Minidiscs appear to be hot and are the brightest components of EM emission.

Due to the large length scales involved, global simulations of these discs have been restricted to Newtonian calculations which either excise the cavity completely or employ mass sinks with approximate accretion prescriptions.  This is necessary to prevent artificial accumulation of mass near each BH, but wipes out all detailed structure of the minidiscs themselves.

In this work we present the results of two dimensional inviscid general relativistic hydrodynamic simulations of accretion discs around an individual member of a black hole binary. They are built to model minidics seen in global circumbinary calculations, and can be seen as a ``zoomed in'' calculation of the hydrodynamics in the immediate vicinity of one of the black holes.  These calculations serve a double purpose. Firstly they provide a much better resolved view of minidisc emission structure, potentially informing searches for EM counterparts of SMBH binaries.  Secondly, the detailed accretion dynamics can inform the prescriptions used in larger Newtonian simulations, facilitating the approach to a global understanding of circumbinary accretion.

Newtonian calculations have been performed with alpha viscosity and either isothermal \citep{Farris14} or adiabatic \citep{Farris15A, Farris15B} thermodynamics. The adiabatic calculations included local blackbody cooling to dissipate the viscous heat generation, and were shown to lead to the Shakura-Sunyaev disc when performed with a single central black hole.

Although alpha viscosity is typically used to model the unknown angular 
momentum transport mechanism in accretion discs, we find minidiscs accrete with
ideal hydrodynamics alone.  This is due to the presence of spiral shocks excited by the binary companion. These shocks transport angular momentum outwards (cite Binney \& Tremaine?) and locally heat the disc. We include local 
black-body cooling with electron-scattering opacity to remove shock-generated
heat self-consistently from the disc.  This allows the disc to find a natural
temperature equilibrium, and allows a direct estimate of the emission spectrum.

This paper is organized as follows in Section \ref{sec:numerics} we present the
numerical setup used in the calculations; a version of the \DISCO{} code 
modified to work in an arbitrary space-time, with optimizations for thin 
relativistic accretion discs.  In Section \ref{sec:models} we detail the 
minidisc models calculated.  Section \ref{sec:results} analyzes the models and
calculates effective $\alpha$'s and spectra. Results are discussed in Section \ref{sec:discussion} and the work is summarized in \ref{sec:summary}.

%%%%%
%Section 2 - Numerical Setup
%%%%%

\section{Numerical Setup}
\label{sec:numerics}

The basis of our hydrodynamics scheme is the \DISCO{} code; a moving mesh hydro
code optimized for disc geometry. This code was first used in the context of
protoplanetary discs \citep{Duffell12, Duffell13, Duffell14} and later applied 
to circumbinary accretion \citep{Farris14, Farris15A, Farris15B}. 

The original \DISCO{} code has been modified to solve the GRHD equations in a 
fixed space-time:
\begin{equation}
    \nabla_\mu \rho_0 u^\mu = 0 \text{ and } \nabla_\mu T^{\mu\nu} = -\dot{Q} u^\nu , \label{eq:GRHD}
\end{equation}
for a single species gas of rest-mass density $\rho_0$, four velocity $u^\mu$, 
stress energy tensory $T^{\mu\nu}$ and local isotropic cooling $\dot{Q}$.  

To solve \eqref{eq:GRHD} numerically one must make a choice of which elements of $T^{\mu\nu}$ to be independent variables.  We follow the standard Valencia formulation (CITE) (also cite HARM, Duez2004, etc) for the momentum variables $T^0_i$ and choose an energy variable projected onto a known four-velocity $U^\mu$: $-U_\mu T^{\mu 0}$.
In terms of coordinate derivatives \eqref{eq:GRHD} takes the standard flux-balanced conservation form
\begin{equation}
    \pd_0 \mathcal{U} + \pd_j \mathcal{F}^j = \mathcal{S} , \label{eq:consLaw}
\end{equation}
with conserved variables
\begin{equation}
    \mathcal{U} = \begin{pmatrix} D \\
                            S_i \\
                            \tau_U
                \end{pmatrix} = \sqrt{-g} \begin{pmatrix} \rho_0 u^0 \\ 
                                                    T^0_i \\
                                                    -U^\mu T_\mu^0 - \rho_0 u^0 \end{pmatrix} , \label{eq:cons}
\end{equation}
fluxes
\begin{equation}
    \mathcal{F}^j = \sqrt{-g} \begin{pmatrix} \rho_0 u^j \\
                                                T^j_i \\
                                                -U^\mu T_\mu^j \end{pmatrix} ,\label{eq:fluxes}
\end{equation}
and source terms 
\begin{equation}
    \mathcal{S} = \sqrt{-g} \begin{pmatrix} 0 \\
                        \frac{1}{2}T^{\mu\nu}\pd_i g_{\mu\nu} - \dot{Q}u_i \\
                        T^{\mu\nu}\nabla_\mu U_\nu + U^\mu u_\mu \dot{Q} \end{pmatrix} .\label{eq:sources}
\end{equation}

In this work we assume an ideal gas with stress tensor
\begin{equation}
	T^{\mu\nu} = \rho_0 h u^\mu u^\nu + P g^{\mu\nu} ,
\end{equation}
where $P$ is the gas pressure, $h = 1 + \eps + P/\rho_0$ the relativistic specific enthalpy, and $\eps$ the specific internal energy. Furthermore we assume the gamma law equation of state
\begin{equation}
	P = (\Gam - 1) \rho_0 \eps . \label{eq:gammalaw}
\end{equation}

\DISCO{} is a Godunov type code which solves hyperbolic systems of equations of the form \eqref{eq:consLaw} on a moving mesh in cylindrical coordinates ($r$, $\phi$, $z$).  The mesh motion is restricted to be in the $\phi$-direction, which greatly reduces numerical viscosity due to bulk azimuthal flow.  For radial flows, the code performs at the same level as fixed mesh codes.  In this work, the velocities of cell interfaces are fixed to $V^\phi \equiv U^\phi/U^0$.   

\DISCO{} is second order accurate in time and space.  It uses the piecewise linear method (PLM) to interpolate the cell-centred primitive values to the cell interfaces for the Riemann fluxes.  The relativistic HLLC approximate Riemann solver (CITE Mignone and Bodo) is employed to calculate intercell fluxes, and the time evolution is performed via the RK2-TVD algorithm of (CITE SHU).  The time step is Courant limited with a typical CFL number of $0.1$.

All calculations in this work are performed in two dimensions spatial dimensions ($r$ and $\phi$) using vertically integrated fluid quantities and metric terms evaluated on the equator $z=0$.  We denote the surface density as $\Sig_0 = \int \dd z \rho_0$ and the vertically integrated pressure $\Pi = \int \dd z P$.  

\subsection{The Energy Variable $\tau_U$}
\label{subsec:energy}

Thin accretion discs are highly supersonic: $\Mach = u^{\hat{\phi}} \sqrt{1-c_s^2}/c_s \gg 1$.  This is a challenge for (grid-based?) hydro codes, as the specific internal energy $\eps \sim cs^2$ while the specific kinetic energy $w-1 \sim \tilde{u}^2$, giving $\eps / (w-1) \sim \OO(\Mach^{-2})$.  For hydro codes based on conservation laws, the energy variable must necessarily contain both the kinetic and internal energies.  However, the kinetic energy is due to the bulk motion of the fluid, and largely determined by the momentum equations (for Newtonian codes this is exactly true).  The energy equation is solved exclusively to track the internal energy of the fluid, but for supersonic flows the internal energy is a small perturbation on top of the total energy.  This makes the internal energy subject to much larger truncation (?) errors than the other fluid quantities.

Several schemes exist to combat this issue.  ORBITAL ADVECTION? FARGO? The Newtonian \DISCO{} code includes the option to specify an exact rotation profile $\Om(r)$, and chooses as its energy variable $\frac{1}{2}\rho v_r^2 + \frac{1}{2}\rho(v_\phi-r\Om)^2 + \rho \eps$; subtracting the kinetic energy associated with $\Om$. This introduces source terms in the energy equation proportional to $\pd_r \Om$, which are exactly known since $\Om(r)$ is exactly known.  When $\Om$ is chosen close to the fluid $v_\phi / r$ this subtraction allows for accurate evolution of the internal energy even for very thin (high $\Mach$) discs (CITE?).

Our energy variable $\tau_U$ is the relativistic analogue to the Newtonian scheme.  Subtracting the kinetic energy associated with some bulk motion can be seen as simply measuring the energy in a particular frame with a velocity near the fluid velocity. We specify an exactly known four-velocity $U^\mu(x^\nu)$ and define the energy as the projection of the stress energy tensor onto this time-like vector $-U_\mu T^{\mu 0}$.  We also perform the standard operation of subtracting the rest-mass energy from the total energy to arrive at our energy variable:
\begin{equation}
	\tau_U = -U_\mu T^{\mu 0} - D \ . \label{eq:tauU}
\end{equation}
This is very similar to the energy variable $\tau$ used by (HARM, Duez04):
\begin{equation}
	\tau = -n_\mu T^{\mu 0} - D \ , \label{eq:tau}
\end{equation}
where $n^\mu$ is the unit time-like normal vector. In fact, the choice of \eqref{eq:tau} can be seen as just making the choice to measure energy with respect to normal observers.  It is easy to determine: %HA
\begin{equation}
\tau_U + D = W\left(\tau + D\right) - \gamma^{ij}U_i S_j  \ ,
\end{equation}
where $W = -n_\mu U^\mu$ is the $U$ Lorentz factor in the coordinate frame.

If $U^\mu$ is chosen sufficiently close to the fluid velocity then the dominant component of $\tau_U$ will be the internal energy.  In the case of a thin accretion disc around a black hole, we use a $U^\mu$ which is Keplerian outside the innermost stable circular orbit (ISCO) and smoothly plunging inside.  For a Schwarzschild black hole of mass $M$ this takes the form (in Schwarzschild coordinates):
\begin{align}
	U^0 &= \left \{ \begin{matrix} \frac{2\sqrt{2}/3}{1-2M/r} & r < 6M \\
						\frac{1}{\sqrt{1-3M/r}} & r > 6M \end{matrix} \right . , \nonumber \\
	U^r &= \left \{ \begin{matrix} -\frac{1}{3}\sqrt{\frac{6M}{r}-1} & r < 6M \\
						0 & r > 6M \end{matrix} \right . , \nonumber \\
	U^\phi &= \left \{ \begin{matrix}  \frac{2 \sqrt{3} M}{r^2} & r < 6M \\
						\sqrt{\frac{M/r^3}{1-3M/r}} & r > 6M \end{matrix} \right . . \label{eq:Ugeo}
\end{align}

We find using $\tau_U$ instead of $\tau$ essential for accurately evolving thin discs with even moderate mach numbers.

\subsection{Radiative Cooling}
\label{subsec:cooling}

We restrict our attention to optically thick discs, where radiative cooling occurs at the local black body rate. We impose a cooling function (CITE FRANK\&KING)
\begin{equation}
	\dot{Q} = \frac{8}{3} \frac{\sig T^4}{\ka \Sig} , \label{eq:BBcooling}
\end{equation}
where $\sig$ is the Stefan-Boltzmann constant, $T = m_p \Pi / \Sig$ is the gas temperature (assuming pure Hydrogen), and $\ka $ is the opacity.  We assume the dominant opacity is due to electron scattering and take $\ka = \ka_{es} = 0.4 cm^2/g$.

EASIER TO JUST SAY OPERATOR SPLITTING?

Because of the strong dependence on temperature in \eqref{eq:BBcooling} the cooling time scale can be much shorter than the local hydrodynamic time scale.  To avoid large restrictions on the global time step we exactly solve an evolution equation for the temperature subject to cooling.  Since time evolution in \DISCO{} is performed via the method of lines it is sufficient to prescribe a first order in time implementation of cooling.  The evolution equation for the specific internal energy is:
\begin{equation}
	\pd_t \eps = -\frac{u^i}{u^0} \pd_i \eps - \frac{\Pi}{\Sig u^0} \nabla_\mu u^\mu - \frac{1}{\Sig u^0} \dot{Q} . \label{eq:epsEvolution}
\end{equation}
The terms on the right hand side of \eqref{eq:epsEvolution} are energy loss due to advection, expansion, and cooling respectively.  The Riemann solver already takes into account advection and expansion, so to first order in time we can consider just the evolution due to cooling
\begin{equation}
	\pd_t \eps \approx - \frac{1}{\Sig u^0} \dot{Q} \ .
\end{equation}
To first order in time the surface density $\Sig$ and the fluid velocity $u^\mu$ are unchanged by cooling.  Therefore one can write the following equation for the temperature evolution due to cooling:
\begin{equation}
	\pd_t T = - \left(\frac{\pd \eps}{\pd T}\right)_{\Sig}^{-1} \frac{\dot{Q}}{\Sig u^0} \ . \label{eq:Tevolution}
\end{equation}
Cooling in \DISCO{} is implemented in the following way.  At the beginning of a time step we have the primitives $\mathcal{P}^0$ and corresponding conservatives $\mathcal{U}^0$.  The Riemann solver and geometric source terms produce $\mathcal{U}^1_{hydro}$.  The initial temperature $T^0$ is evolved by integrating \eqref{eq:Tevolution}, keeping $\Sig$ and $u^0$ held to their initial values.  With the equation of state \eqref{eq:gammalaw} and $\ka = \ka_{es}$ this can be done exactly, yielding $T^1_{cooling}$.  We define the first-order change in $\mathcal{U}$ due to cooling as $\De \mathcal{U}_{cooling} = \mathcal{U}(T^1_{cooling}) - \mathcal{U}^0$.  Then the final value of the conservatives is $\mathcal{U}^1 = \mathcal{U}^1_{hydro} +\De \mathcal{U}_{cooling}$.

\subsection{Frame and Tidal Forces}
\label{subsec:frameforces}

We perform all calculations in a frame co-orbiting with the secondary black hole.  In this frame the dominant contribution to the metric is that of the secondary black hole itself, which we take to be the Schwarzschild metric in Kerr-Schild coordinates.  We then perform a coordinate transformation to a frame rigidly rotating with the binary frequency $\Om_{bin}$, which is equivalent to adding a shift $\be^\phi = \Om_{bin}$ to the metric.  This shift automatically adds both Coriolis and centrifugal forces to the equations of motion for the gas.

Incorporating the tidal forces due to the primary cannot be done exactly, as there is no exact metric for a binary black hole.  We make a pragmatic choice and include tidal forces as quasi-Newtonian source terms to the energy and momentum equations, which should be valid in the limit of large binary separation.

A source is added to the second of \eqref{eq:GRHD} in the following way:
\begin{equation}
	\nabla_\mu T^{\mu\nu} = -\dot{Q} u^\nu - f^\nu . 
\end{equation}
This modifies \eqref{eq:sources} as:
\begin{equation}
	\mathcal{S} = \sqrt{-g} \begin{pmatrix} 0 \\
                        \frac{1}{2}T^{\mu\nu}\pd_i g_{\mu\nu} - \dot{Q}u_i  + f_i \\
                        T^{\mu\nu}\nabla_\mu U_\nu + U^\mu u_\mu \dot{Q} - U^\mu f_\mu \end{pmatrix} .\label{eq:sources}
\end{equation}
Requiring the force satisfy $u^\mu f_\mu = 0$ gives $f_0$ as a function of $f_i$.  The spatial components $f_i$ are determined from the Newtonian tidal forces.  The primary black hole $M_1$ has a fixed location $\vec{a}$ relative to the secondary at the origin.  In an orthonormal frame at position $\vec{r}$ we specify $\vec{f}$ as:
\begin{equation}
	\vec{f} = \Sig h (u^0)^2 \left( -\vec{\nabla} \Phi_N \right) \ ,
\end{equation}
where $-\vec{\nabla} \Phi_N$ is:
\begin{equation}
	-\nabla \Phi_{N} = M_1 \left( -\frac{\vec{r} - \vec{a}}{|\vec{r}-\vec{a}|^3} - \frac{\vec{a}}{a^3}\right)\ .
\end{equation}
Then $f_r = (\vec{f})_r$ and $f_\phi = r(\vec{f})_\phi$.


%%%%%
%Section 3 - Minidisc Models
%%%%%

\section{Minidisc Models}
\label{sec:models}

Early work on circumbinary accretion predicted a cavity to form within $r<2a$, where $a$ is the binary separation. Global Newtonian hydrodynamics calculations confirmed the existence of a cavity but also demonstrated the presence of smaller accretion discs (``minidiscs'') around each member of the binary.  These minidiscs are fed by streams falling ballistically off the cavity wall, revealing the essential role non-axisymmetry plays in accreting binary systems.

To model the growth and structure of minidiscs we must specify both the parameters of the binary black hole system and the accretion stream.  The binary mass $M = M_1+M_2$ can be taken to be arbitrary, essentially setting the length scale $GM/c^2$.  We restrict our attention to circular binaries, and fix the separation to be $a = 100M$.  This is the separation where gravitational wave emission begins to dominate the binary orbital dynamics. (CITE)  This is an astrophysically interesting separation, as general relativistic effects should begin to become important for the hydrodynamics, but still provides enough of a scale separation between the separation and event horizons of the black holes that our approximate treatment of tidal forces should be valid.  We run calculations for several mass ratios.

We model the accretion streams as radial infall through the $L2$ Lagrange point of the binary.  The radial velocity is set to be $v^r = -1/2 v_{bin}$, where $v_{bin} = \sqrt{M/a}$ is the binary orbital velocity.  The angular velocity of the stream is zero in the co-rotating frame.  Since the streams are ballistic the sound speed should be significantly less than the stream velocity.  To ensure this, we set the pressure in the stream as $\Pi = 5 \times 10^{-6} \Sig$.  Several values of this parameter were used during testing, we found they did not affect the resulting minidisc. Rather shock heating and radiative cooling allow the gas to find its own equilibrium temperature once its incorporated into the disc.  We run several different accretion rates, and set the density in the stream accordingly.

The numerical grid is centred on the secondary BH and extends from $4 M_2$ to $R_{L2}$, the radius of the $L2$ Lagrange point. Radial zones are distributed logarithmically and azimuthal zones are placed to keep the aspect ratio of cells close to unity.  On the outer boundary away from the stream a diode boundary condition is used: zero gradient in all fluid variables with the radial velocity restricted to be positive.  The stream extends over $\phi \in [-0.2, 0.2]$, with the grid zones fixed to the stream parameters.  

At the inner boundary a hybrid boundary condition is used.  The fluid velocity is set to be exactly \eqref{eq:Ugeo}, appropriate for ballistic matter infalling on geodesics.  The density is set to be $\Sig = -\dot{M} / r U^r \De \phi$, where $\dot{M}$ is calculated from the innermost non-boundary annulus.  Given $\Sig$, the pressure $\Pi$ is set to ensure isentropic infall.

Although the inner boundary is outside the event horizon of the secondary, we find it does not affect the evolution of the system.  This is because it is still inside the sonic radius of the flow, so no information can propagate out to the minidisc itself.  

Because of the dimensionfull parameters in \eqref{eq:BBcooling} the structure of minidiscs will qualitatively differ as $\dot{M}$ is varied.  As such we consider several values of $\dot{M}$ and several values of $q$.  The lowest value of $\dot{M}$ corresponds to the discs considered in \cite{Farris14}, where the initial disc profile had $\mathcal{M}(a) = 32$.  We then step in factors of 10 over four orders of magnitude.  We consider mass ratios $q = 0.11, 0.43, 1.0$.

%%%%%
%Section 4 - Results
%%%%%

\section{Results}
\label{sec:results}

Each model was run for 30 $T_{bin}$ on the Pleiades cluster at NASA AMES.

\subsection{Fiducial Run}
\label{subsec:fiducial}

Here's a disc Fig \ref{fi:sig}.

\begin{figure*}
\plotone{figs/q011_m3_sig.png}
\caption{\label{fi:sig} Surface density for fiducial minidisc after 28 orbits.  Magenta dashed lines are level curves of the Roche potential corresponding to the L1 and L2 Lagrange points.}
\end{figure*}

\subsection{Wave Propagation}
\label{subsec:prop}

A linear perturbation to a fluid quantity of azimuthal mode $m$ and pattern speed $\Omega_P$ can be written as:
\begin{equation}
	\delta X(t, r, \phi) = A_{m,\omega}(r) \exp \left( i \int_r k(r) \dd r  + i m (\phi \Omega_P t) \right)\ . \label{eq:pert}
\end{equation}
Such perturbations are spirals with pitch angle $\tan \theta = m / k r$. The hydro equations for such a mode reduce to a system of ODEs in the radial coordinate $r$.  In the `tight winding' limit $k' / k \gg A'/A$, the perturbation is highly oscillatory, and the WKB approximation may be used to yield the well-known (CITE BinneyTreamaine) dispersion relation for tightly wound waves in a gaseous disc:
\begin{equation}
	\Omega^2 - m^2(\Omega-\Omega_P)^2 + c_s^2 k^2 = 0 \ . \label{eq:dispNewt}
\end{equation}
A generalization of \eqref{eq:dispNewt} to a disc in the Schwarzschild metric is straightforward. Keeping \eqref{eq:pert} as the definition of a perturbation quantity, the same process used to derive \eqref{eq:dispNewt} can be applied to the relativistic hydro equations \eqref{eq:GRHD}. The state to perturb around is a constant density, isentropic disc with fluid velocity \eqref{eq:Ugeo}.  Assuming the disc is cold ($c_s \ll 1$) then leads to the relativistic dispersion relation:
\begin{equation}
	\frac{1-6M/r}{1-2M/r}\left(U^\phi\right)^2 - m^2(U^\phi-U^0\Omega_P)^2 + \left(1-2M/r\right) c_s^2 k^2 = 0 \ . \label{eq:dispRel}
\end{equation}
In Schwarzschild coordinates the perturbation remains a spiral with the same opening angle as in the Newtonian case.  The dispersion relation can be solved for the radial wave number $k$ yielding:
\begin{align}
	\tan \theta &= \left( \frac{r U^\phi}{c_s} \right)^{-1} \left(1-\frac{2M}{r}\right)^{\frac{1}{2}} \label{eq:dispRelPitch} \\ \nonumber
		&\times \left(\left(1- \frac{U^0 \Omega_P}{U^\phi}\right)^2 - \frac{1}{m^2}\frac{1-6M/r}{1-2M/r}\right)^{-\frac{1}{2}}\ . 
\end{align}
Shocks, of course, are intrinsically non-linear perturbations to a fluid flow.  Weak shocks, however, travel very near the local sound speed and can be approximated as linear waves.  The degree to which spiral shocks in the minidiscs satisfy \eqref{eq:dispRelPitch} can be used to gauge their non-linearity.  

In Figure \ref{fi:disp} we plot the pitch angle of shocks found in the minidisc calculations against the average Mach number of each annulus. The pitch angle is determined by first identifying at each radius the angular position of the two greatest peaks in $\Sigma(r)$, giving $\Phi_i(r)$, where $i=A,B$ identifies the particular shock. Then $\tan \theta_i$ is calculated by numerically differencing $\Phi_i(r)$. We find good agreement between the numerically calculated pitch angles and the theoretical relationship $\eqref{eq:dispRelPitch}$, indicating the shocks propagate mostly in the linear regime.

\begin{figure}
\plotone{figs/q011_m3_tanq_mach.png}
\caption{\label{fi:disp} Dispersion relation for spiral waves in the fiducial run. Blue and orange crosses correspond to the primary and secondary shock, respectively.  Grey line is the prediction for tightly wound waves from the WKB approximation.}
\end{figure}

% Calculate difference between true value and analytic? Plot as function of r?


\subsection{Shock Dissipation}
\label{subsec:diss}

To quantitatively measure the coupling between the spiral shocks and the bulk disc flow we measure the irreversible heating at each shock in post-processing. 

To locate shocked gas in the simulation output we employ a relativistic shock detector (CITE Rezzolla/Zanotti).  The basic algorithm compares neighbouring zones and classifies the interface as a shock if the relative normal velocity $v_{12} \equiv (v_1 - v_2) / (1-v_1 v_2)$ between the zones is greater than the maximum possible relative velocity produced by a rarefaction wave $(v_{12})_{\mathcal{RS}}$.  We find this algorithm to be somewhat too sensitive in detecting shocks, so we restrict it in the following way.  For a fluid cell to be considered part of a shockwave, it must satisfy: 1) $v_{12} - (v_{12})_{\mathcal{RS}} > \Delta v_{amb}$, where $\Delta v_{amb}$ is the peak ambient value of $v_{12} - (v_{12})_{\mathcal{RS}}$ in the annulus under consideration and 2) the entropy flux must be positive: $v^i \partial_i s > 0$.

We locate shocking gas at each annulus of the computational grid and compute the jump in specific entropy $\Delta s_i = s_{i,b} - s_{i,a}$ over each shock.  The specific irreversible heating is $\propto \psi_Q \equiv \exp{(\Delta s_i)} - 1$ (CITE RAFIKOV).  The irreversible heating at each annulus in the limit of small radial velocity is:
\begin{equation}
	\dot{Q}_{irr} = \sum_i \left( r\Sigma u^\phi T \right)_{i,a} \psi_{Q,i} \ .
\end{equation}

Figure \ref{fi:diss} shows the radial profiles of $\Delta S$, $\psi_Q$, $\dot{Q}_{irr}$, and $\dot{Q}_{cool}$ for the fiducial minidisc.  Note that $\dot{Q}_{irr}$ ignores heating (cooling) due to adiabatic compression (expansion).  We find $\psi_Q \sim$ a few $10^{-1}$.

\begin{figure}
\plotone{figs/q011_m3_diss_r.png}
\caption{\label{fi:diss} Radial profiles of shock quantities in the fiducial run.  From top to bottom the entropy jump $\De s$, $\psi_Q$, and irreversible heating $\dot{Q}_{irr}$ and cooling $\dot{Q}_{cool}$.}
\end{figure}

\subsection{Angular Momentum Transport}
\label{subsec:angmom}

Dissipation in the fluid flow is an (inevitable?) sign of angular momentum transport, and hence accretion. Indeed in every simulation under consideration the accretion rate through the inner boundary (into the black hole) was matched by the accretion rate through the outer boundary (matter injection from the nozzle).  A quasi-equilibrium, where the inner and outer accretion rates match, typically occurred within a few ($<10$) $T_{bin}$. 

The relative strength of an accretion flow is typically measured by determining an effective Shakura-Sunyaev (or Novikov-Thorne) $\al$-parameter.  The gravitational forces of the companion, plus the global character of the shocks providing the dissipation, make $\al_{eff}$ a somewhat fuzzy notion.  We present two measures of $\al_{eff}$.  First, following (CITE STONE CV), we calculate the $\al$ required at each radii for a Novikov-Thorne disc of the same average temperature and accretion rate.  Second, (CITE RAFIKOV) determines for shocked Newtonian discs $\al_{eff} \sim \psi_Q / 3\pi$.  We take this same prescription without modification, as $\psi_Q$ is a scalar quantity and hence frame independent.  

The radial profiles of both $\al_{\dot{M}}$ and $\al_{\dot{Q}}$ are plotted in Fig \ref{fi:alpha} for the fiducial run.  We see they are broadly similar across the disc, except near the ISCO at $r=6M$ where $\al_{\dot{M}}$ diverges.  Both indicate 

\begin{figure}
\plotone{figs/q011_m3_alpha_r.png}
\caption{\label{fi:alpha} Radial profile of effective $\al$ parameters in the fiducial run measured from the accretion rate $\al_{\dot{M}}$ (blue) and the local dissipation $\al_{\dot{Q}}$ (orange).}
\end{figure}




%%%%%%
% Discussion %
%%%%%%

\section{Discussion}
\label{sec:discussion}



%%%%%%
% Summary %
%%%%%%

\section{Summary}
\label{sec:summary}




%%%%%%
% Acknowledgements %
%%%%%%

\section{Acknowledgements}


\newpage

%%%%%%
% Bibliography %
%%%%%%

\bibliography{minidisc_sources}

%%%%%%
% Appendix %
%%%%%%

%\include{appendix}

\end{document}
